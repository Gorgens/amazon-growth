---
title: "Material e Métodos"
output: html_document
---

```{r pacotes2, echo=FALSE}
require(tidyverse)
require(magrittr)
require(reshape2)
require(ggplot2)
require(V.PhyloMaker)
require(phytools)
require(knitr)
```
Foram utilizados inventarios florestais do projeto Paisagens Sustentáveis Brasil, disponíveis na plataforma (https). Foram considerados 28 inventários distribuídos nos estados do Pará, Amazonas, Mato Grosso, Acre e Rondônia. Foram medidas 355 parcelas, contendo 41079 árvores. Para a sequência da análise, excluímos os indivíduos menores que 10 cm e as palmeiras. Cada espécie foi associada a um grupo ecológico seguindo a proposta de MacPherson (AAAA). Das 415 espécies identificadas em campo, foi possivel associar 90 espécies aos grupos ecológicos. 

```{r limparInventario, echo=FALSE}
invMerged = read.csv("dados/10_invPaisagensMerged.csv")
nParcelasAntes = length(unique(paste(invMerged$area, invMerged$plot)))

invMerged = invMerged %>%
  filter(type == "O" | is.na(type)) %>%
  drop_na(DBH) %>%
  filter(DBH >= 10)

nParcelasFiltrado = length(unique(paste(invMerged$area, invMerged$plot)))
```

```{r numeroParcelas, echo=FALSE}
parcelasArea = invMerged %>%
  group_by(area, plot, subplot, year) %>%
  summarise(obs = n())  %>%
  group_by(area, year) %>%
  summarise(nplots = n())

parcelasArea
```


Apresentar cálculo do incremento diamétrico anual e o crescimento diamétrico relativo...

$$growth = \frac{d_f - d_i}{t_f - t_i}$$

$$RGrowth = \frac{growth}{d_i}$$
Apresentar os grupos ecológicos... 

```{r gruposEcologicos, echo=FALSE}
grupoEco = read.csv('auxiliar/grupoEcologico.csv')
eco = grupoEco %>% group_by(GrupoEco) %>% summarise(Species = n())
```

Calculo do incremento por grupo ecológico...

```{r pareamentoIncremento, echo=FALSE}
incEco = invMerged %>%
  drop_na(GrupoEco) %>%
  filter(GrupoEco != "OUTROS") %>%
  group_by(area, plot, subplot, tree, scientific.name, GrupoEco) %>%
  summarise(med = n(),
            cc = min(cc), 
            minDBH = min(DBH), 
            maxDBH = max(DBH), 
            inc = max(DBH) - min(DBH), 
            intervMed = max(year) - min(year), 
            incAnual = ifelse(inc == 0, 0.01, inc / intervMed),
            rInc = incAnual / minDBH) %>%
  filter(med > 1)
  
```


